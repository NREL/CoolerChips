<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}">
<title>Server Thermal Profiles - MOSTCOOL</title>
<link rel="icon" href="{{ url_for('static', filename='icons/icon.ico') }}" type="image/x-icon">
</head>
<body>
  <div class="d-flex flex-column sidebar p-4">
    <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
      <span class="fs-4">MOSTCOOL</span>
    </a>
    <hr>
    <ul class="nav nav-pills flex-column mb-auto">
      <li class="nav-item">
        <a href="/simulation-setup" class="nav-link text-white">
          Simulation Setup
        </a>
      </li>
      <li class="nav-item">
        <a href="/simulation" class="nav-link text-white">Simulation</a>
      </li>
      <li class="nav-item">
        <a href="/results" class="nav-link text-white">
          Results
        </a>
      </li>
    </ul>
    <hr>
  </div>
  <main class="flex-fill main-content p-4">
    <div class="pt-3 pb-2">
      <h2>Server Thermal Profiles</h2>
      <p>Visualize the server board thermal profile in Paraview Web! Select the velocity, server inlet temperature, and CPU load fraction that you would like to visualize. Then click "Visualize". Loading the visualization will take some time (Up to 5 minutes).</p>
      <form id="thermal-form">
        <div class="mb-3">
          <label for="velocity" class="form-label">Velocity: [m/s]</label>
          <input type="number" class="form-control" id="velocity" name="velocity" min="6" max="15" value="15" required>
        </div>
        <div class="mb-3">
          <label for="server-temp" class="form-label">Server Inlet Temperature: [C]</label>
          <input type="number" class="form-control" id="server-temp" name="server_temp" min="0" max="100" value="70" required>
        </div>
        <div class="mb-3">
          <label for="cpu-load" class="form-label">CPU Load Fraction: [-]</label>
          <input type="number" class="form-control" id="cpu-load" name="cpu_load" min="0.5" max="1" step="0.01" value="0.73" required>
        </div>
        <button type="submit" class="btn btn-primary">Visualize</button>
      </form>
    </div>
  </main>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
document.getElementById('thermal-form').addEventListener('submit', function(event) {
    event.preventDefault();
    const formData = new FormData(event.target);
    const data = {
        velocity: formData.get('velocity'),
        server_temp: formData.get('server_temp'),
        cpu_load: formData.get('cpu_load')
    };

    fetch('/run-paraview', {
        method: 'POST',
        headers: {
            'Content-Type': 'application/json',
        },
        body: JSON.stringify(data)
    })
    .then(response => response.json())
    .then(data => {
        if (data.status === 'success') {
            console.log('Paraview opened successfully.');
            window.open('http://0.0.0.0:1234', '_blank');
        } else {
            console.error('Error:', data.error);
        }
    })
    .catch(error => {
        console.error('Error:', error);
    });
});
</script>
</body>
</html>
